<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-01-22">

<title>Scaling Narrative Fiscal Shock Identification with LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-06b787a0ed8c4f8090820bc5bd1fe0b9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../docs/proposal.html">Docs</a></li><li class="breadcrumb-item"><a href="../docs/proposal.html">Scaling Narrative Fiscal Shock Identification with LLMs</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../docs/proposal.html">Docs</a></li><li class="breadcrumb-item"><a href="../docs/proposal.html">Scaling Narrative Fiscal Shock Identification with LLMs</a></li></ol></nav>
      <h1 class="title">Scaling Narrative Fiscal Shock Identification with LLMs</h1>
            <p class="subtitle lead">Concept Note</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 22, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Scaling Fiscal Shocks</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scaling Narrative Fiscal Shock Identification with LLMs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Docs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/proposal.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Scaling Narrative Fiscal Shock Identification with LLMs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/two_pager.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motivation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/review_model_a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model A Evaluation: Act Detection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/review_model_b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model B Evaluation: Motivation Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/review_training_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training Data Quality Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/test_text_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PDF Extraction Quality Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/verify_body.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Document Extraction Verification: <code>r params$country</code></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/20260117.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phase 0 Progress Report: Data Extraction and Validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/20260121-model-a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model A Progress Report: Automated Detection of Fiscal Policy Acts</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="proposal.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://github.com/estebandegetau/Fiscal-shocks/" target="_blank"><i class="bi bi-github"></i>GitHub Repo</a></li></ul></div></div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><strong>Task Team Lead:</strong> Agustín Samano</p>
<p><strong>Country/Region:</strong> United States (training), Malaysia (pilot), Southeast Asia (extension)</p>
<p><strong>Timeline:</strong></p>
<ul>
<li>US training / benchmarking: January 2026</li>
<li>Malaysia pilot: February 2026</li>
<li>Core multi-country dataset: June 2026</li>
</ul>
<section id="introduction-and-motivation" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction-and-motivation"><span class="header-section-number">1</span> Introduction and Motivation</h2>
<p>Fiscal policy plays a central role in macroeconomic stabilization, long-run growth, and private-sector development. Yet we lack credible and comparable <strong>exogenous fiscal shock series</strong> for most emerging markets. Existing international evidence is heavily skewed toward the United States and a few OECD countries, due to the <strong>high cost</strong> of constructing narrative datasets like those of <span class="citation" data-cites="romer2010">Romer and Romer (<a href="#ref-romer2010" role="doc-biblioref">2010</a>)</span> or <span class="citation" data-cites="mertens2013">Mertens and Ravn (<a href="#ref-mertens2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Romer and Romer’s narrative analysis of postwar US tax changes provides act-by-act classifications of tax legislation, their motivations (spending-driven, countercyclical, deficit-driven, long-run), and the timing and size of revenue effects. These labels are exactly the kind of supervised signal that modern language models can learn from.</p>
<p>The rise of <strong>Large Language Models (LLMs)</strong> offers a practical pathway to extend the narrative approach systematically to developing countries. Governments now publish large volumes of digitized legislative documents, budget speeches, and parliamentary transcripts, often in multiple languages. Manually processing these sources is infeasible; LLMs can drastically reduce the bottleneck <strong>if</strong> they are trained and validated against high-quality human benchmarks first.</p>
<p>This project proposes to:</p>
<ol type="1">
<li><strong>Train and benchmark an LLM-assisted classifier on the US</strong> using the Romer &amp; Romer tax shock dataset and underlying narrative sources as labels and text.</li>
<li><strong>Adapt and validate this trained system to Malaysia</strong> as a pilot country.</li>
<li><strong>Scale to Indonesia, Thailand, the Philippines, and Vietnam</strong>, combining LLMs, multilingual translation, and human validation.</li>
</ol>
<p>The outputs will be:</p>
<ol type="1">
<li>A <strong>US-based benchmark module</strong>: LLM classifiers and extraction routines that can reproduce US narrative tax shocks from raw documents.</li>
<li>A <strong>narrative episode dataset</strong> for each SEA country based on executive, legislative, and press documents.</li>
<li>A <strong>shock-event dataset</strong> representing actual changes in fiscal liabilities or expenditure paths, classified into the <span class="citation" data-cites="romer2010">Romer and Romer (<a href="#ref-romer2010" role="doc-biblioref">2010</a>)</span> motivation categories.</li>
<li>A set of <strong>macro and firm-level impulse responses</strong> to fiscal shocks using local projections and modern difference-in-differences methods (LP-DiD).</li>
</ol>
<p>These will constitute the first systematic narrative fiscal shock series for Southeast Asia, backed by an explicit US benchmark.</p>
</section>
<section id="research-questions" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="research-questions"><span class="header-section-number">2</span> Research Questions</h2>
<p>The project focuses on four core questions:</p>
<ol type="1">
<li><p><strong>US Benchmarking / LLM Training:</strong> Can an LLM trained on the <strong>US narrative corpus</strong> and Romer &amp; Romer’s tax-shock labels reliably:</p>
<ul>
<li>detect fiscal acts,</li>
<li>classify their motivations, and</li>
<li>recover the timing and size of tax shocks closely enough to reproduce known US fiscal multipliers?</li>
</ul></li>
<li><p><strong>Measurement in Emerging Markets:</strong> Conditional on a successful US benchmark, can we construct reliable narrative-based fiscal shock series for Southeast Asian economies using the same LLM architecture, multilingual translation, and human validation?</p></li>
<li><p><strong>Validation and Transportability:</strong></p>
<ul>
<li>How closely do LLM-based classifications align with (i) expert assessments and (ii) contemporaneous news coverage in each country?</li>
<li>Are the identified exogenous shocks orthogonal to short-run macro conditions?</li>
<li>How much degradation (if any) occurs when moving from US to Malaysia and from Malaysia to other SEA contexts?</li>
</ul></li>
<li><p><strong>Impact:</strong> What are the dynamic effects of tax and spending shocks on:</p>
<ul>
<li>GDP, investment, FDI, employment, revenue, and expenditure?</li>
<li>Firm-level outcomes such as investment and employment?</li>
</ul></li>
</ol>
</section>
<section id="proposed-approach" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="proposed-approach"><span class="header-section-number">3</span> Proposed Approach</h2>
<p>We structure the work in <strong>three phases</strong>, with a deliberate <strong>Phase 0 on the US</strong> to de-risk the entire pipeline.</p>
<section id="phase-0-us-training-and-benchmarking-2025" class="level3">
<h3 class="anchored" data-anchor-id="phase-0-us-training-and-benchmarking-2025">Phase 0: US Training and Benchmarking (2025)</h3>
<p><strong>Objective:</strong> Use the US as a sandbox to train and stress-test the LLM pipeline before touching emerging market data.</p>
<section id="data" class="level4">
<h4 class="anchored" data-anchor-id="data">Data</h4>
<ul>
<li><p>Romer &amp; Romer’s narrative dataset of postwar US federal tax actions (timing, size, motivation, present-value paths).</p></li>
<li><p>Underlying narrative sources:</p>
<ul>
<li>Economic Report of the President</li>
<li>Budget of the United States Government</li>
<li>Treasury Annual Reports</li>
<li>Presidential speeches and statements</li>
<li>Congressional reports and debates</li>
</ul></li>
</ul>
</section>
<section id="tasks" class="level4">
<h4 class="anchored" data-anchor-id="tasks">Tasks</h4>
<ol type="1">
<li><p><strong>Corpus reconstruction and alignment</strong></p>
<ul>
<li>Reconstruct the narrative corpus used in <span class="citation" data-cites="romer2010">Romer and Romer (<a href="#ref-romer2010" role="doc-biblioref">2010</a>)</span>.</li>
<li>Align each tax act in the Romer &amp; Romer dataset with the source passages used to classify its motivation and revenue effects.</li>
</ul></li>
<li><p><strong>LLM-based Act Detection (Model A)</strong></p>
<ul>
<li>Train models to detect <strong>candidate fiscal acts</strong> and relevant passages in long documents (e.g., ERP chapters, budget speeches).</li>
<li>Use Romer &amp; Romer’s list of 50 significant postwar tax actions as positive labels and randomly sampled irrelevant passages as negatives.</li>
</ul></li>
<li><p><strong>LLM-based Motivation Classification (Model B)</strong></p>
<p>Using <strong>Romer &amp; Romer’s four-way motivation</strong>: spending-driven, countercyclical, deficit-driven, long-run/structural,</p>
<ul>
<li><p>Fine-tune or instruction-tune a modest-size LLM (suitable for local hardware) on:</p>
<ul>
<li>input: narrative passage(s) around the tax change,</li>
<li>output: motivation label + structured explanation.</li>
</ul></li>
<li><p>Embed <strong>best-practice rules for narrative work</strong> (real-time sources, explicit criteria, documentation) from Romer &amp; Romer’s 2023 Presidential Address on the narrative approach.</p></li>
</ul></li>
<li><p><strong>Information Extraction for Timing and Magnitude (Model C)</strong></p>
<ul>
<li><p>Train models (or rule-based + LLM hybrid) to extract:</p>
<ul>
<li>quarter of change in liabilities,</li>
<li>present-value quarter,</li>
<li>revenue impact (baseline and present value).</li>
</ul></li>
<li><p>Compare extracted values with Romer &amp; Romer’s act-quarter series.</p></li>
</ul></li>
<li><p><strong>US Back-Testing</strong></p>
<ul>
<li><p>Re-estimate US tax multipliers using only <strong>LLM-generated</strong> episodes and shocks:</p>
<ul>
<li>aggregate, exogenous tax changes à la <span class="citation" data-cites="romer2010">Romer and Romer (<a href="#ref-romer2010" role="doc-biblioref">2010</a>)</span>,</li>
<li>dynamic effects via local projections.</li>
</ul></li>
<li><p>Benchmark whether:</p>
<ul>
<li>sign and timing match the original estimates,</li>
<li>magnitudes are within acceptable bands (e.g., ±20–30%).</li>
</ul></li>
<li><p>This gives a <strong>quantitative yardstick</strong> for “good enough” LLM performance.</p></li>
</ul></li>
</ol>
<p>Deliverable of Phase 0: an <strong>audited, documented LLM toolkit</strong> that can (i) reconstruct the US series reasonably well and (ii) be ported to other countries with known limitations.</p>
</section>
</section>
<section id="phase-1-malaysia-pilot-2025" class="level3">
<h3 class="anchored" data-anchor-id="phase-1-malaysia-pilot-2025">Phase 1: Malaysia Pilot (2025)</h3>
<p>Malaysia is the optimal starting point due to extensive English-language archives and relatively stable political institutions.</p>
<section id="data-sources" class="level4">
<h4 class="anchored" data-anchor-id="data-sources">Data Sources</h4>
<ul>
<li>Parliamentary transcripts, Hansards</li>
<li>Budget speeches and fiscal policy statements</li>
<li>Bills and explanatory memoranda</li>
<li>Prime Minister / Minister of Finance speeches</li>
<li>Official press releases</li>
<li>Secondary validation archives (international/local newspapers)</li>
</ul>
</section>
</section>
<section id="narrative-identification-strategy" class="level3">
<h3 class="anchored" data-anchor-id="narrative-identification-strategy">Narrative Identification Strategy</h3>
<p>The project distinguishes two levels of analysis:</p>
<ol type="1">
<li><p><strong>Narrative Episodes (Talk)</strong> All instances where policymakers discuss tax or spending actions. Output: a comprehensive episode-level dataset with motivation labels.</p></li>
<li><p><strong>Shock Events (Action)</strong> Subset of episodes that result in measurable changes to fiscal liabilities/expenditures (legislated or executive). Output: a shock-event dataset for econometric analysis (timing, size, tax base, motivation).</p></li>
</ol>
</section>
<section id="llm-pipeline-human-in-the-loop" class="level3">
<h3 class="anchored" data-anchor-id="llm-pipeline-human-in-the-loop">LLM Pipeline (Human-in-the-Loop)</h3>
<p>We reuse the <strong>US-trained models</strong> as the backbone and adapt them to Malaysia.</p>
<p><strong>Step 1 — Ingestion &amp; Parsing</strong> Automatic collection and segmentation of documents into candidate narrative episodes, using the Act Detection model trained in Phase 0 and adjusted to Malaysian document formats.</p>
<p><strong>Step 2 — Translation</strong> LLM-based translation for non-English texts into English, with:</p>
<ul>
<li>consistent terminology for fiscal concepts,</li>
<li>retention of uncertainty / qualifications in the original text.</li>
</ul>
<p><strong>Step 3 — Motivation Classification (US-initialized)</strong></p>
<p>Each episode is classified into Romer &amp; Romer’s four motivation categories, using the US-trained classifier as a prior:</p>
<ul>
<li>Spending-driven</li>
<li>Countercyclical</li>
<li>Deficit-driven</li>
<li>Long-run/structural</li>
</ul>
<p>The LLM produces:</p>
<ul>
<li>a proposed label,</li>
<li>a short justification using explicit criteria (e.g., “responding to current macro weakness” vs “paying for a new program”),</li>
<li>a confidence score,</li>
<li>an “inconsistency flag” comparing <strong>stated motives</strong> (in-text) to <strong>inferred motives</strong> (based on macro context).</li>
</ul>
<p><strong>Step 4 — Domain Adaptation &amp; Human Validation</strong></p>
<ul>
<li><p>Draw stratified samples by:</p>
<ul>
<li>label,</li>
<li>model confidence,</li>
<li>time period,</li>
<li>type of document.</li>
</ul></li>
<li><p>Local experts review and re-label:</p>
<ul>
<li>obvious misclassifications (e.g., misreading of local institutional language),</li>
<li>ambiguous cases (e.g., mixed motivations).</li>
</ul></li>
<li><p>Use these corrections to:</p>
<ul>
<li>update prompts and decision rules,</li>
<li>optionally fine-tune the model on Malaysia-specific examples (few-shot adaptation).</li>
</ul></li>
</ul>
<p><strong>Step 5 — Shock Identification</strong></p>
<ul>
<li><p>Cross-walk narrative episodes with:</p>
<ul>
<li>actual legislation,</li>
<li>implementation regulations,</li>
<li>budget tables.</li>
</ul></li>
<li><p>Code whether and when <strong>tax/spending liabilities</strong> actually change:</p>
<ul>
<li>change in liabilities (quarter, size, tax base),</li>
<li>present value of announced changes,</li>
<li>exogenous vs endogenous classification (based on motivation and timing, as in <span class="citation" data-cites="romer2010">Romer and Romer (<a href="#ref-romer2010" role="doc-biblioref">2010</a>)</span>).</li>
</ul></li>
</ul>
</section>
<section id="phase-2-extension-to-indonesia-thailand-the-philippines-vietnam-20252026" class="level3">
<h3 class="anchored" data-anchor-id="phase-2-extension-to-indonesia-thailand-the-philippines-vietnam-20252026">Phase 2: Extension to Indonesia, Thailand, the Philippines, Vietnam (2025–2026)</h3>
<ul>
<li><p>Apply the same pipeline, with:</p>
<ul>
<li>country-specific corpus discovery and scraping,</li>
<li>language adaptation (translation and terminology),</li>
<li>targeted human validation in each country.</li>
</ul></li>
<li><p>Leverage <strong>transfer learning</strong>:</p>
<ul>
<li>US → Malaysia serves as the main calibration jump,</li>
<li>Malaysia → other SEA countries leverages experience with mixed English/local language environments and similar fiscal institutions.</li>
</ul></li>
</ul>
</section>
</section>
<section id="validation" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="validation"><span class="header-section-number">4</span> Validation</h2>
<p>The project embeds a rigorous, multi-method validation strategy, now explicitly in <strong>two layers</strong>: US and SEA.</p>
<section id="us-benchmark-validation" class="level3">
<h3 class="anchored" data-anchor-id="us-benchmark-validation">1. US Benchmark Validation</h3>
<ul>
<li><p>Compare LLM-derived US shocks to Romer &amp; Romer’s original series:</p>
<ul>
<li>confusion matrix for motivation labels,</li>
<li>distribution of timing errors (quarter misalignment),</li>
<li>revenue size errors (absolute and relative).</li>
</ul></li>
<li><p>Re-run baseline US macro regressions using:</p>
<ul>
<li>local projections for GDP, investment, and unemployment,</li>
<li>exogenous tax changes only.</li>
</ul></li>
<li><p>Require that impulse response functions are <strong>qualitatively identical</strong> and <strong>quantitatively close</strong> to original published estimates before deploying the model to SEA.</p></li>
</ul>
</section>
<section id="expert-review-in-sea" class="level3">
<h3 class="anchored" data-anchor-id="expert-review-in-sea">2. Expert Review in SEA</h3>
<ul>
<li>Engage World Bank economists (including KL office) and local experts.</li>
<li>Evaluate a stratified sample of episodes and shocks in each country.</li>
<li>Document disagreements systematically to refine classification rules and prompts.</li>
</ul>
</section>
<section id="news-based-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="news-based-cross-validation">3. News-Based Cross-Validation</h3>
<ul>
<li><p>Use institutional access (e.g.&nbsp;ITAM, WB) to global and regional newspaper archives.</p></li>
<li><p>Assess whether contemporaneous reporting aligns with classified motivations, especially for:</p>
<ul>
<li>sharp tax hikes or cuts,</li>
<li>politically sensitive episodes,</li>
<li>“borderline” exogenous vs endogenous cases.</li>
</ul></li>
</ul>
</section>
<section id="internal-consistency-checks" class="level3">
<h3 class="anchored" data-anchor-id="internal-consistency-checks">4. Internal Consistency Checks</h3>
<ul>
<li>Test correlation of “exogenous” shocks with real-time macro indicators (GDP, unemployment, inflation).</li>
<li>Exogenous shocks should show weak contemporaneous correlation with short-run macro conditions; if not, re-examine classification.</li>
</ul>
<p>This two-tier validation (US + SEA) turns the US into a <strong>truth-benchmark</strong> and SEA into the <strong>test of portability</strong>.</p>
</section>
</section>
<section id="empirical-analysis" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="empirical-analysis"><span class="header-section-number">5</span> Empirical Analysis</h2>
<section id="macro-level-effects" class="level3">
<h3 class="anchored" data-anchor-id="macro-level-effects">1. Macro-Level Effects</h3>
<p>Use <strong>local projections</strong> to estimate dynamic responses of:</p>
<ul>
<li>GDP growth</li>
<li>Private investment</li>
<li>FDI</li>
<li>Employment</li>
<li>Government revenue and expenditure</li>
</ul>
<p>Separate estimates will be produced for:</p>
<ul>
<li>tax vs spending shocks,</li>
<li>personal vs corporate income tax shocks (where identifiable),</li>
<li>exogenous vs endogenous shocks.</li>
</ul>
</section>
<section id="firm-level-effects" class="level3">
<h3 class="anchored" data-anchor-id="firm-level-effects">2. Firm-Level Effects</h3>
<p>Using firm-level panels (e.g.&nbsp;Orbis, national administrative data where available), estimate how fiscal shocks affect:</p>
<ul>
<li>investment,</li>
<li>employment,</li>
<li>capital formation.</li>
</ul>
<p>Identification:</p>
<ul>
<li><strong>LP-DiD (Local Projections DiD)</strong> following Dube et al.&nbsp;(2022), which unifies local projections with clean-control difference-in-differences in staggered treatment settings.</li>
<li>Treatment assignment based on exposure (e.g., sector-level tax incidence, import/export orientation, foreign ownership).</li>
</ul>
<p>This will generate the first micro-based fiscal multipliers for these countries.</p>
</section>
</section>
<section id="outputs-and-deliverables" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="outputs-and-deliverables"><span class="header-section-number">6</span> Outputs and Deliverables</h2>
<section id="by-mid-2025-us-benchmark" class="level3">
<h3 class="anchored" data-anchor-id="by-mid-2025-us-benchmark">By mid-2025 (US Benchmark)</h3>
<ul>
<li><p>Reconstructed US narrative corpus aligned with Romer &amp; Romer tax acts.</p></li>
<li><p>Trained and documented LLM modules:</p>
<ul>
<li>act detection,</li>
<li>motivation classification,</li>
<li>timing and magnitude extraction.</li>
</ul></li>
<li><p>Quantitative comparison of LLM-based vs original US tax multipliers.</p></li>
</ul>
</section>
<section id="by-december-2025-malaysia-pilot-completion" class="level3">
<h3 class="anchored" data-anchor-id="by-december-2025-malaysia-pilot-completion">By December 2025 (Malaysia Pilot Completion)</h3>
<ul>
<li>Fully operational R-based and LLM-assisted pipeline for Malaysia.</li>
<li>Narrative episode dataset (Malaysia).</li>
<li>First version of the shock-event dataset (Malaysia).</li>
</ul>
</section>
<section id="by-early-february-2026-pilot-validation" class="level3">
<h3 class="anchored" data-anchor-id="by-early-february-2026-pilot-validation">By early February 2026 (Pilot Validation)</h3>
<ul>
<li>Expert- and news-based validation for a subset of Malaysian episodes and shocks.</li>
<li>Technical documentation and reproducible code for the Malaysia pipeline.</li>
</ul>
</section>
<section id="by-june-2026-core-dataset-completion" class="level3">
<h3 class="anchored" data-anchor-id="by-june-2026-core-dataset-completion">By June 2026 (Core Dataset Completion)</h3>
<ul>
<li>Narrative and shock-event datasets for: Malaysia, Indonesia, Thailand, the Philippines, Vietnam.</li>
<li>Harmonized multi-country episode and shock datasets.</li>
<li>Fully validated motivation classification framework and LLM toolkit.</li>
<li>Public dissemination-ready code and documentation (subject to licensing/permissions).</li>
</ul>
</section>
<section id="post-2026-analytical-outputs" class="level3">
<h3 class="anchored" data-anchor-id="post-2026-analytical-outputs">Post-2026 (Analytical Outputs)</h3>
<ul>
<li><p>Macro-level impact study of tax and spending shocks in SEA.</p></li>
<li><p>Firm-level impact study using LP-DiD.</p></li>
<li><p>Methodological paper on <strong>LLM-assisted narrative identification</strong>, emphasizing:</p>
<ul>
<li>US benchmark reproduction,</li>
<li>cross-country transportability,</li>
<li>human-in-the-loop design.</li>
</ul></li>
<li><p>Data package for public release (subject to permissions).</p></li>
</ul>
</section>
</section>
<section id="risks-and-mitigation" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="risks-and-mitigation"><span class="header-section-number">7</span> Risks and Mitigation</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Risk</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Incomplete/uneven archives</td>
<td>Combine multiple sources; transparently document coverage; adjust sample windows.</td>
</tr>
<tr class="even">
<td>Translation inaccuracies</td>
<td>Dedicated translation stage; manual checks; standardized prompts and glossaries.</td>
</tr>
<tr class="odd">
<td>LLM misclassification</td>
<td>US-based benchmarking; human-in-the-loop refinement; conservative thresholds for exogeneity.</td>
</tr>
<tr class="even">
<td>Domain shift US → SEA</td>
<td>Explicit diagnostics on model confidence, label drift, and validation error; country-specific fine-tuning where needed.</td>
</tr>
<tr class="odd">
<td>Political bias in narrative documents</td>
<td>Cross-check with news; inconsistency flags; robust alternative classifications.</td>
</tr>
<tr class="even">
<td>Weak identification for some countries</td>
<td>Use Malaysia as a strong pilot; downweight uncertain periods; exploit LP-DiD with clean controls.</td>
</tr>
</tbody>
</table>
</section>
<section id="policy-relevance-and-value-added-to-the-world-bank" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="policy-relevance-and-value-added-to-the-world-bank"><span class="header-section-number">8</span> Policy Relevance and Value Added to the World Bank</h2>
<ul>
<li>Fills critical data gaps for fiscal-policy modeling in major middle-income economies.</li>
<li>Provides <strong>scalable infrastructure</strong> for narrative shock identification, with a <strong>US-validated LLM core</strong> exportable to other regions (Latin America, South Asia, Africa).</li>
<li>Enhances understanding of <strong>how fiscal policy affects private investment and firm behavior</strong>, central to the Bank’s structural reform and growth agenda.</li>
<li>Supports better macroeconomic forecasting and policy advice in client countries by plugging a key missing input: credible exogenous fiscal shocks.</li>
</ul>
<p>The project also showcases responsible, auditable use of LLMs for applied economic research—grounded in best-practice narrative methods —rather than opaque black-box automation.</p>
</section>
<section id="references" class="level2 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-mertens2013" class="csl-entry" role="listitem">
Mertens, Karel, and Morten O. Ravn. 2013. <span>“<a href="https://doi.org/10.1257/aer.103.4.1212">The Dynamic Effects of Personal and Corporate Income Tax Changes in the United States</a>.”</span> <em>American Economic Review</em> 103 (4): 1212–47.
</div>
<div id="ref-romer2010" class="csl-entry" role="listitem">
Romer, Christina D, and David H Romer. 2010. <span>“<a href="https://doi.org/10.1257/aer.100.3.763">The Macroeconomic Effects of Tax Changes: Estimates Based on a New Measure of Fiscal Shocks</a>.”</span> <em>American Economic Review</em> 100 (3): 763–801.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/estebandegetau\.github\.io\/Fiscal-shocks\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>